<script>
var at = null;
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '178552545941568',
      xfbml      : true,
      version    : 'v2.6'
    });
  };

  (function(d, s, id){

     var js, fjs = d.getElementsByTagName(s)[0];

     if (d.getElementById(id)) {return;}

     js = d.createElement(s); js.id = id;

     js.src = "//connect.facebook.net/en_US/sdk.js";

     fjs.parentNode.insertBefore(js, fjs);

   }(document, 'script', 'facebook-jssdk'));

   FB.getLoginStatus(function(response) {

   if (response.status === 'connected') {
    alert(response.authResponse.accessToken);
  }

});

function checkLoginState() {
  FB.login(function(response) {
    if (response.authResponse) {
     // alert('Welcome!  Fetching your information.... ');
     FB.api('/me', function(response) {
       // alert('Good to see you, ' + response.name + '. '+response.email);
     });
    } else {
     // alert('User cancelled login or did not fully authorize.');
    }
});
  FB.getLoginStatus(function(response) {

   if (response.status === 'connected') {
    // alert("This is accessToken from facebook API: "+response.authResponse.accessToken);
    at = response.authResponse.accessToken;
  }
  FB.api('/me', { locale: 'en_US', fields: 'name, first_name, last_name, link, email, about, birthday, context, hometown, quotes, relationship_status, religion, gender' },function(response) {

        var fname = response.first_name;
        var lname = response.last_name;
        var email = response.email;
        var timeline = response.link;
        var picture = 'https://graph.facebook.com/'+response.id+'/picture?width=930&type=large&access_token='+at;
        var gender = response.gender;
   
      alert(fname+","+lname+", "+email+", "+timeline+", "+picture+", "+gender);
      
  		$("#test").val(picture);

	JSON.stringify(response);
});
FB.logout(function(response) {
   // Person is now logged out
});

  });

}
</script>

<fb:login-button data-size="xlarge"
  scope="public_profile,email"
  onlogin="checkLoginState();">
</fb:login-button>


